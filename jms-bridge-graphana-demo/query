CREATE STREAM TIME_USER_EVENTS AS SELECT floor(TS/120)*120 as `time`, * FROM USER_EVENTS_AVRO;

CREATE TABLE USER_COUNTER AS SELECT count( AIRPORT ) as `counter`,  AIRPORT  FROM USER_EVENTS_AVRO WINDOW HOPPING (SIZE 30 SECONDS, ADVANCE BY 10 SECONDS) GROUP BY AIRPORT;

CREATE TABLE STATUSES AS SELECT STATUS as `TravelerStatus`, COUNT(STATUS) as `Total` FROM USER_EVENTS_AVRO WINDOW HOPPING (SIZE 30 SECONDS, ADVANCE BY 10 SECONDS) GROUP BY `STATUS` EMIT CHANGES;